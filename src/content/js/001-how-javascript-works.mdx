---
title: How JavaScript Works?
slug: 001-how-javascript-works
category: js
date: 1709019681
description: How does your JS code complies into machine code? Let's dive a little deeper to learn more about how JavaScript works.
---

When you run your JS code, somehow it complies and got execute in your browser or server. How does your JS code complies into machine code? Let's dive a little deeper to learn more about how JavaScript works.

<Heading id="js-engine" title="What is JS Engine?">
A JS Engine is a piece of program which execute your JS code. So that means JS can execute not only on
browser but also on any piece of device which have JS Engine. Every browser have their own version of JS Engine. For Example...
- V8 in Chrome, Opera, Edge and even Node
- Chakra in IE
- Spider Monkey in FireFox

<Callout>
  Earlier JS was only limited to run on browser as a client slide language only.
  With Node JS, JS can also be used on server and to execute JS Node JS use V8
  engine. In simple terms
  <br />
  <Code>Node JS = V8Engine + Node API/Modules</Code>
</Callout>

<Image
  variant='half'
  src='/_assets/js/001-01.png'
  alt='JS Engine'
  content={
    <section>
      Any JS Engine contain two main components
      <ul>
        <li>
          Call Stack: A call stack is where your code get executed inside
          Execution Context.
        </li>
        <li>
          Heap: A heap is unstructured memory pool, which stores all the objects
          that your application needed.
        </li>
      </ul>
    </section>
  }
  caption='[Fig 1.1] JS Engine'
/>

<SubHeading id="call-stack-and-execution-context" title="Call stack & Execution Context">
An Execution context(EC) is where your JS code will get executed so all the necessary information about your code being run will be stored inside EC. Each EC have two phases
- Creation Phase
- Execution Phase

<SubHeading id="creation-phase" title="The Creation Phase">
When the JS Engine execute your JS Code for the first time, before even executing you code it will create the <Code>Global Execution Context</Code> which is default EC and contain top-level code.
During this Phase JS Engine will do following tasks
- Create a <Code>global</Code> object, window object in browser & global object in Node.
- Bind <Code>this</Code> to global object
- Creation of Scope Chain
- Store function declaration in memory and initialize the variables with undefined inside GEC.

So each Execution Context store

- A Variable Environment
  - let, const, var declaration
  - function and arguments
- A Scope Chain
- this keyword
  </SubHeading>

<SubHeading id="execution-phase" title="The Execution Phase">
During execution phase Engine will run JS code line by line and assign value to variables and executes the functions. For each function call, JS Engine will create new context push it into stack, known as call stack, for it knows as <Code>Function Execution Context</Code>. Unlike Global, Function EC represent the function local scope so it will only have local variables.

</SubHeading>
</SubHeading>
<br/>
</Heading>

<Heading id="v8-engine" title="A brief intro of V8 Engine">

<Image
  variant='half'
  src='/_assets/js/001-02.png'
  alt='V8 Engine'
  content={
    <p>
      The JS file enters the engine and the <Code>parser</Code> parses the file,
      does lexical analysis break the code into a token which will be used in
      the creation of an <Code>Abstract syntax tree</Code> (AST).
      <br />
      <br />
      Now generated AST will be passed down to <Code>interpreter</Code> which generate
      the un-optimized code and execution can start with no delay. profiler will
      watch the code as it runs and identifies the area where it require the optimization.
      profiler will pass that code to <Code>complier</Code> that perform optimization
      and generate optimized code that can replace its counterpart in non-optimized
      code generated by the interpreter.
      <br />
      <br />
      As the profiler and compiler constantly make changes to the bytecode, the
      JavaScript execution performance gradually improves.
    </p>
  }
  caption='[Fig 1.2] V8 Engine'
/>

<Callout>
In V8 Engine, JS is interpreted by an interpreter called <Code>Ignition</Code> as well as compiled by a JIT-optimized complier called <Code>TurboFan</Code>
</Callout>
</Heading>

<Heading id="js-runtime" title="What is JS Runtime?">
JS Engine run inside environment, which provide additional features to the scripts which we can use at the runtime.

<Image
  variant='half'
  src='/_assets/js/001-03.gif'
  alt='JS Runtime'
  content={
    <ol>
      <li>
        JS scripts get access to WEB API which is not part of native JS for
        example DOM, AJAX, setTimeout etc.
      </li>
      <li>
        JS runtime also includes Event loop and Callback queue.
        <ul>
          <li>
            When scripts start running, first all the sync code execution. All
            the callback associated with some event that callback function will
            be queued in the callback queue.
          </li>
          <li>
            Now job of event loop is to the take the callback function which is
            ready to execute and if call stack is empty put the callbacks into
            the call stack for execution.
          </li>
        </ul>
      </li>
    </ol>
  }
  caption='[Fig 1.3] JS Runtime'
/>

</Heading>
